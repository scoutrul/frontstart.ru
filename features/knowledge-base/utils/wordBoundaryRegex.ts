/**
 * Создает регулярное выражение для поиска слова с границами, поддерживающее кириллицу
 * 
 * @param word - слово для поиска
 * @param flags - флаги регулярного выражения (по умолчанию 'i' для case-insensitive)
 * @returns регулярное выражение с границами слов для кириллицы и латиницы
 */
export const createWordBoundaryRegex = (word: string, flags: string = 'i'): RegExp => {
  // Экранируем специальные символы регулярных выражений
  const escapedWord = word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  
  // Для коротких слов (меньше 5 символов) используем строгие границы с обеих сторон
  // Для длинных слов (>= 5 символов) позволяем вхождение как префикс (без границы справа)
  // Это позволяет находить "программиста", "программистов" при поиске "программист"
  const useStrictBoundaryRight = word.length < 5;

  const pattern = `(?<![а-яёА-ЯЁa-zA-Z0-9])${escapedWord}${useStrictBoundaryRight ? '(?![а-яёА-ЯЁa-zA-Z0-9])' : ''}`;
  
  return new RegExp(pattern, flags);
};
