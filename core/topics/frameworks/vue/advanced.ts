import { Topic } from '../../../types';

export const VUE_ADVANCED_TOPICS: Topic[] = [
  {
    id: 'vue-performance',
    title: 'Производительность',
    difficulty: 'advanced',
    description: 'Производительность Vue оптимизируется через: оптимизации рендеринга (v-memo для мемоизации поддеревьев), lazy loading компонентов, code splitting, оптимизацию реактивности. Vue 3 имеет лучшую производительность чем Vue 2 благодаря новой реактивности на Proxy и улучшенному tree-shaking.\n\nОптимизации рендеринга: v-memo мемоизирует поддерево компонента, предотвращая лишние ререндеры. Lazy loading компонентов снижает размер начального бандла. Code splitting разбивает код на части, загружаемые по мере необходимости. Оптимизация реактивности через shallowRef и markRaw для больших объектов.\n\nИнструменты оптимизации: Vue Devtools для профилирования, webpack-bundle-analyzer для анализа бандла, Lighthouse для метрик производительности. Понимание оптимизации критично для создания производительных приложений.\n\nВ 2026 производительность Vue остаётся сильной стороной. Vue 3 имеет лучшую производительность чем Vue 2, а будущие версии (Vue 4 с Vapor mode) обещают ещё лучшую производительность. Понимание оптимизации критично для создания производительных приложений.',
    keyPoints: [
      'Оптимизации: v-memo, lazy loading, code splitting, оптимизация реактивности',
      'v-memo: мемоизирует поддерево компонента',
      'Vue 3: лучшая производительность благодаря Proxy и tree-shaking',
      'Инструменты: Vue Devtools, webpack-bundle-analyzer, Lighthouse',
      'Сильная сторона Vue в 2026',
      'Критично для создания производительных приложений'
    ],
    funFact: 'Vue 3 был оптимизирован для лучшей производительности: на 41% меньше размер бандла, на 55% быстрее рендеринг, на 133% быстрее обновления по сравнению с Vue 2. Это было достигнуто через новую реактивность на Proxy и улучшенный tree-shaking.',
    tags: ['vue', 'performance', 'optimization', 'v-memo', 'advanced'],
    examples: [
      {
        title: 'v-memo',
        code: `// v-memo: мемоизация поддерева
<template>
  <div v-for="item in items" :key="item.id" v-memo="[item.id, item.name]">
    <ExpensiveComponent :data="item" />
  </div>
</template>

// Поддерево мемоизируется
// Перерисовывается только при изменении item.id или item.name
// Не перерисовывается при изменении других props

// Преимущество: предотвращает лишние ререндеры
// Особенно полезно для больших списков`
      },
      {
        title: 'Оптимизация реактивности',
        code: `// Оптимизация реактивности для больших объектов
import { shallowRef, markRaw } from 'vue';

// shallowRef: отслеживает только изменения ссылки
const largeObject = shallowRef({
  // Большой объект с множеством свойств
  data: [...]
});

// markRaw: помечает объект как нереактивный
const chartInstance = markRaw(new Chart(config));

// Преимущество: меньше overhead на отслеживание
// Полезно для больших объектов или сторонних библиотек`
      },
      {
        title: 'Lazy loading',
        code: `// Lazy loading компонентов
import { defineAsyncComponent } from 'vue';

const HeavyComponent = defineAsyncComponent(() => 
  import('./HeavyComponent.vue')
);

// Компонент загружается только при первом использовании
// Не входит в начальный бандл

// Преимущество: снижает размер начального бандла
// Улучшает Time to Interactive`
      }
    ],
    relatedTopics: ['vue-migration-vue2-vue3', 'frameworks-performance-memoization'],
    isFrontendEssential: false
  },
  {
    id: 'vue-migration-vue2-vue3',
    title: 'Миграция Vue 2 → Vue 3',
    difficulty: 'advanced',
    description: 'Миграция Vue 2 → Vue 3 — это процесс обновления проекта с Vue 2 на Vue 3. Стратегии миграции: постепенная миграция через @vue/compat (compatibility build), полная миграция (переписывание на Vue 3 API), гибридный подход (часть на Vue 2, часть на Vue 3). Выбор зависит от размера проекта и рисков.\n\nИнструменты миграции: @vue/compat для совместимости (позволяет использовать Vue 2 код в Vue 3), migration build для автоматического обнаружения проблем, автоматические скрипты для преобразования кода. Это упрощает миграцию, но требует тестирования.\n\nОсновные breaking changes: глобальный API изменён (Vue.component → app.component), фильтры удалены (использовать computed или методы), $listeners удалён (события в $attrs), изменения в реактивности (Proxy вместо Object.defineProperty). Проблемы и решения: обновление плагинов (многие плагины требуют обновления), работа с Vuex → Pinia (миграция хранилища), обновление роутера (Vue Router 4 для Vue 3).\n\nВ 2026 миграция Vue 2 → Vue 3 остаётся актуальной, так как многие проекты всё ещё на Vue 2. Понимание миграции критично для работы с legacy кодом и планирования обновлений.',
    keyPoints: [
      'Миграция: постепенная через @vue/compat, полная, гибридный подход',
      'Инструменты: @vue/compat, migration build, автоматические скрипты',
      'Breaking changes: глобальный API, фильтры, $listeners, реактивность',
      'Проблемы: обновление плагинов, Vuex → Pinia, обновление роутера',
      'Тестирование после миграции: что проверить, типичные ошибки',
      'Критично для работы с legacy кодом в 2026'
    ],
    funFact: 'Vue 3 был разработан с обратной совместимостью в уме, но некоторые breaking changes были необходимы для улучшения производительности и TypeScript поддержки. @vue/compat был создан специально для упрощения миграции, позволяя использовать Vue 2 код в Vue 3.',
    tags: ['vue', 'migration', 'vue2', 'vue3', 'breaking-changes', 'advanced', 'core'],
    examples: [
      {
        title: 'Стратегии миграции',
        code: `// Постепенная миграция через @vue/compat
import { createApp } from 'vue';
import { configureCompat } from 'vue';

// Включаем режим совместимости
configureCompat({
  MODE: 2 // Vue 2 режим
});

const app = createApp(App);
app.mount('#app');

// Преимущество: Vue 2 код работает в Vue 3
// Можно мигрировать постепенно
// Меньше рисков

// Полная миграция
// Переписать весь код на Vue 3 API
// Больше работы, но чище результат`
      },
      {
        title: 'Breaking changes',
        code: `// 1. Глобальный API изменён
// Vue 2:
Vue.component('MyComponent', {...});
Vue.use(plugin);

// Vue 3:
import { createApp } from 'vue';
const app = createApp({});
app.component('MyComponent', {...});
app.use(plugin);

// 2. Фильтры удалены
// Vue 2:
{{ message | capitalize }}

// Vue 3: использовать computed или методы
const capitalized = computed(() => capitalize(message));

// 3. $listeners удалён
// Vue 2: $listeners для событий
// Vue 3: события в $attrs`
      },
      {
        title: 'Проблемы и решения',
        code: `// Проблемы миграции:
// 1. Обновление плагинов
// Многие плагины требуют обновления для Vue 3
// Решение: проверить совместимость, обновить или заменить

// 2. Vuex → Pinia
// Vuex 4 работает с Vue 3, но Pinia рекомендуется
// Решение: мигрировать на Pinia постепенно

// 3. Обновление роутера
// Vue Router 4 для Vue 3
// Решение: обновить роутер, проверить breaking changes

// 4. Изменения в реактивности
// Proxy вместо Object.defineProperty
// Решение: проверить код, использующий реактивность
// Особенно для массивов и объектов

// Тестирование после миграции:
// - Проверить все функции
// - Проверить производительность
// - Проверить совместимость плагинов`
      }
    ],
    relatedTopics: ['vue-vue2-vs-vue3', 'vue-vue-next'],
    isFrontendEssential: true
  },
  {
    id: 'vue-vue-next',
    title: 'Vue Next (4+)',
    difficulty: 'advanced',
    description: 'Vue Next (4+) — это будущая версия Vue с Vapor mode и улучшенной реактивностью. Vapor mode — это новый режим рендеринга, который компилирует компоненты в более эффективный код, снижая runtime overhead. Улучшенная реактивность обещает ещё лучшую производительность и простоту использования.\n\nVapor mode: компилирует компоненты в более эффективный код, снижая overhead на Virtual DOM. Это даёт лучшее из обоих миров: хороший DX и низкий runtime cost. Улучшенная реактивность: более эффективное отслеживание зависимостей, меньше overhead, лучше производительность.\n\nСпекуляция о Vue 4+: Vapor mode станет стандартом, реактивность улучшится, TypeScript поддержка станет ещё лучше. Но основы останутся: компонентная модель, реактивность, экосистема. Понимание направления развития критично для долгосрочной карьеры.\n\nВ 2026 Vue Next (4+) находится в разработке. Vapor mode обещает значительные улучшения производительности. Понимание направления развития помогает подготовиться к будущему.',
    keyPoints: [
      'Vue Next (4+): Vapor mode и улучшенная реактивность',
      'Vapor mode: компилирует компоненты в более эффективный код',
      'Улучшенная реактивность: более эффективное отслеживание',
      'Спекуляция: Vapor mode станет стандартом, основы останутся',
      'В разработке в 2026',
      'Понимание направления развития критично для долгосрочной карьеры'
    ],
    funFact: 'Vapor mode был анонсирован в 2023 году как экспериментальная функция Vue. Идея в том, что компиляция может устранить необходимость в Virtual DOM, давая лучшую производительность при сохранении знакомого синтаксиса Vue.',
    tags: ['vue', 'vapor-mode', 'future', 'vue4', 'advanced'],
    examples: [
      {
        title: 'Vapor mode',
        code: `// Vapor mode: компилирует компоненты
// Исходный код:
<script setup>
let count = 0;
</script>

<template>
  <button @click="count++">{count}</button>
</template>

// Компилятор генерирует оптимизированный код
// Нет Virtual DOM overhead
// Прямое обновление DOM
// Минимальный runtime

// Преимущество: лучшая производительность
// Компилируется в эффективный код
// Низкий runtime overhead`
      },
      {
        title: 'Улучшенная реактивность',
        code: `// Улучшенная реактивность Vue Next
// Более эффективное отслеживание зависимостей
// Меньше overhead
// Лучшая производительность

// Текущая реактивность Vue 3:
const state = reactive({ count: 0 });

// Улучшенная реактивность Vue Next:
// - Более эффективное отслеживание
// - Меньше overhead
// - Лучшая производительность

// Преимущество: сильная сторона Vue остаётся сильной
// Реактивность становится ещё лучше`
      },
      {
        title: 'Спекуляция о будущем',
        code: `// Vue Next (4+) вероятные изменения:
// 1. Vapor mode станет стандартом
// Компиляция компонентов
// Низкий runtime overhead

// 2. Улучшенная реактивность
// Более эффективное отслеживание
// Лучшая производительность

// 3. Лучшая TypeScript поддержка
// Ещё лучше типизация
// Меньше boilerplate

// Но основы останутся:
// - Компонентная модель
// - Реактивность
// - Экосистема

// Понимание основ остаётся важным
// Адаптация к новому будет проще`
      }
    ],
    relatedTopics: ['vue-migration-vue2-vue3', 'frameworks-future-compilation-hydration'],
    isFrontendEssential: false
  }
];
